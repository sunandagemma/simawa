<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Superadmin | SIMAWA</title>

    <link rel="icon" type="image/png" href="/image/favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'simawa': {
                            '50': '#BDE8F5', '100': '#9DD9EF', '200': '#7DCAE9',
                            '300': '#4988C4', '400': '#3A7AB8', '500': '#1C4D8D',
                            '600': '#184480', '700': '#143B73', '800': '#0F2854', '900': '#0A1F45',
                        },
                    },
                    fontFamily: { 'inter': ['Inter', 'sans-serif'] },
                },
            },
        }
    </script>
</head>

<body class="bg-gray-50 font-inter">
    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside class="sidebar w-64 bg-gradient-to-b from-[#1C4D8D] to-[#0F2854] text-white fixed h-full z-40">
            <div class="p-6 border-b border-white/10">
                <div class="flex items-center gap-3 w-full">
                    <img src="/image/logo.png" alt="Logo" class="h-16 object-contain bg-white/10 rounded-lg p-2 w-full">
                </div>
            </div>

            <nav class="p-4">
                <ul class="space-y-1">
                    <li><a href="/superadmin/dashboard/"
                            class="sidebar-menu-item flex items-center gap-3 px-3 py-2 rounded-lg text-sm"><ion-icon
                                name="grid" class="text-xl"></ion-icon>Dashboard</a></li>
                </ul>

                <p class="text-xs text-white/50 uppercase tracking-wider mb-3 px-3 mt-6">Menu</p>
                <ul class="space-y-1">
                    <li class="submenu-parent open">
                        <button onclick="this.parentElement.classList.toggle('open')"
                            class="sidebar-menu-item flex items-center justify-between w-full px-3 py-2.5 rounded-lg text-sm">
                            <span class="flex items-center gap-3"><ion-icon name="cloud-done-outline"
                                    class="text-xl"></ion-icon>SIMKATMAWA</span>
                            <ion-icon name="chevron-down-outline"
                                class="text-sm submenu-arrow transition-transform"></ion-icon>
                        </button>
                        <ul class="submenu pl-8 space-y-1 mt-1">
                            <li><a href="/superadmin/kategori-prestasi/"
                                    class="sidebar-menu-item flex items-center gap-3 px-3 py-2 rounded-lg text-sm"><ion-icon
                                        name="medal-outline" class="text-lg"></ion-icon>Kategori Prestasi</a></li>
                            <li><a href="/superadmin/formulir-prestasi/"
                                    class="sidebar-menu-item active flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm"><ion-icon
                                        name="reader-outline" class="text-lg"></ion-icon>Formulir Prestasi</a></li>
                            <li><a href="/superadmin/daftar-prestasi/"
                                    class="sidebar-menu-item flex items-center gap-3 px-3 py-2 rounded-lg text-sm"><ion-icon
                                        name="school-outline" class="text-lg"></ion-icon>Daftar Prestasi</a></li>
                        </ul>
                    </li>

                    <li class="submenu-parent">
                        <button onclick="this.parentElement.classList.toggle('open')"
                            class="sidebar-menu-item flex items-center justify-between w-full px-3 py-2.5 rounded-lg text-sm">
                            <span class="flex items-center gap-3"><ion-icon name="podium-outline"
                                    class="text-xl"></ion-icon>Internal Universitas</span>
                            <ion-icon name="chevron-down-outline"
                                class="text-sm submenu-arrow transition-transform"></ion-icon>
                        </button>
                        <ul class="submenu pl-8 space-y-1 mt-1">
                            <li><a href="/superadmin/jenis-sertifikat/"
                                    class="sidebar-menu-item flex items-center gap-3 px-3 py-2 rounded-lg text-sm"><ion-icon
                                        name="library-outline" class="text-lg"></ion-icon>Jenis Sertifikat</a></li>
                            <li><a href="/superadmin/daftar-mahasiswa/"
                                    class="sidebar-menu-item flex items-center gap-3 px-3 py-2 rounded-lg text-sm"><ion-icon
                                        name="person-circle-outline" class="text-lg"></ion-icon>Daftar Mahasiswa</a>
                            </li>
                            <li><a href="/superadmin/kegiatan/"
                                    class="sidebar-menu-item flex items-center gap-3 px-3 py-2 rounded-lg text-sm"><ion-icon
                                        name="pricetags-outline" class="text-lg"></ion-icon>Kegiatan</a></li>
                        </ul>
                    </li>

                    <p class="text-xs text-white/50 uppercase tracking-wider mb-3 px-3 mt-6">User</p>
                    <li><a href="/superadmin/kegiatan-mahasiswa/"
                            class="sidebar-menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm"><ion-icon
                                name="people-outline" class="text-xl"></ion-icon>Kelola Users</a></li>
                    <li><a href="/superadmin/log-aktivitas/"
                            class="sidebar-menu-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm"><ion-icon
                                name="shield-checkmark-outline" class="text-xl"></ion-icon>Log Aktivitas</a></li>
                </ul>
            </nav>
            <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-white/10">
                <a href="/"
                    class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm hover:bg-white/10 transition-colors"><ion-icon
                        name="log-out" class="text-xl"></ion-icon>Keluar</a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 ml-64">
            <header class="bg-white border-b border-gray-200 sticky top-0 z-30">
                <div class="flex items-center justify-between px-6 py-4">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Formulir Prestasi</h2>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="flex items-center gap-3 pl-4 border-l border-gray-200">
                            <div class="w-10 h-10 rounded-full bg-[#BDE8F5] flex items-center justify-center">
                                <ion-icon name="shield-checkmark" class="text-[#0F2854] text-xl"></ion-icon>
                            </div>
                            <div class="hidden sm:block">
                                <p class="text-sm font-semibold text-gray-800">Superadmin</p>
                                <p class="text-xs text-gray-500">admin@unwahas.ac.id</p>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <div class="p-6">
                <!-- Header Section -->
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800">Daftar Formulir Prestasi</h3>
                        <p class="text-sm text-gray-500 mt-1">Kelola formulir untuk pengajuan prestasi mahasiswa</p>
                    </div>
                    <button onclick="openFormModal()"
                        class="inline-flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-simawa-500 to-simawa-700 text-white rounded-lg hover:from-simawa-600 hover:to-simawa-800 transition-all shadow-lg shadow-simawa-500/25 text-sm font-medium">
                        <ion-icon name="add-circle-outline" class="text-lg"></ion-icon>
                        Buat Formulir Baru
                    </button>
                </div>

                <!-- Forms List -->
                <div id="formsList" class="grid gap-4">
                    <!-- Forms will be rendered here -->
                </div>

                <!-- Empty State -->
                <div id="emptyState"
                    class="hidden bg-white rounded-xl shadow-sm border border-gray-100 py-16 text-center">
                    <ion-icon name="document-text-outline" class="text-6xl text-gray-300 mb-4"></ion-icon>
                    <p class="text-gray-500 mb-2">Belum ada formulir prestasi</p>
                    <button onclick="openFormModal()" class="text-simawa-500 hover:text-simawa-700 font-medium text-sm">
                        + Buat Formulir Baru
                    </button>
                </div>
            </div>

            <!-- Create/Edit Form Modal -->
            <div id="formModal" class="fixed inset-0 z-50 hidden overflow-y-auto">
                <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeFormModal()"></div>
                <div class="flex items-start justify-center min-h-screen p-4 pt-10">
                    <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-3xl transform transition-all">
                        <!-- Modal Header -->
                        <div class="p-6 border-b border-gray-100 flex items-center justify-between">
                            <div>
                                <h3 id="formModalTitle" class="text-lg font-semibold text-gray-800">Buat Formulir Baru
                                </h3>
                                <p class="text-sm text-gray-500 mt-1">Tambahkan pertanyaan dengan berbagai tipe jawaban
                                </p>
                            </div>
                            <button onclick="closeFormModal()"
                                class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                <ion-icon name="close-outline" class="text-xl text-gray-500"></ion-icon>
                            </button>
                        </div>

                        <!-- Modal Body -->
                        <div class="p-6 space-y-6 max-h-[60vh] overflow-y-auto">
                            <input type="hidden" id="editFormId">

                            <!-- Form Title & Category -->
                            <div class="grid sm:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Formulir</label>
                                    <input type="text" id="formTitle" required
                                        class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-simawa-500/20 focus:border-simawa-500 transition-all text-sm"
                                        placeholder="Contoh: Formulir Prestasi Akademik">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Kategori
                                        Prestasi</label>
                                    <select id="formCategory"
                                        class="w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-simawa-500/20 focus:border-simawa-500 transition-all text-sm">
                                        <option value="1">Prestasi Mahasiswa</option>
                                        <option value="2">Penyelenggara Kegiatan</option>
                                        <option value="3">Rekognisi Non Lomba</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Questions Section -->
                            <div>
                                <div class="flex items-center justify-between mb-4">
                                    <label class="block text-sm font-medium text-gray-700">Daftar Pertanyaan</label>
                                    <button onclick="addQuestion()"
                                        class="inline-flex items-center gap-1.5 text-sm text-simawa-500 hover:text-simawa-700 font-medium">
                                        <ion-icon name="add-circle-outline"></ion-icon>
                                        Tambah Pertanyaan
                                    </button>
                                </div>

                                <div id="questionsContainer" class="space-y-4">
                                    <!-- Questions will be rendered here -->
                                </div>

                                <div id="noQuestions"
                                    class="py-8 text-center border-2 border-dashed border-gray-200 rounded-xl">
                                    <ion-icon name="help-circle-outline" class="text-4xl text-gray-300 mb-2"></ion-icon>
                                    <p class="text-gray-400 text-sm">Belum ada pertanyaan</p>
                                    <button onclick="addQuestion()"
                                        class="mt-2 text-simawa-500 hover:text-simawa-700 text-sm font-medium">
                                        + Tambah Pertanyaan Pertama
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Modal Footer -->
                        <div class="p-6 border-t border-gray-100 flex gap-3">
                            <button onclick="closeFormModal()"
                                class="flex-1 px-4 py-2.5 border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-all text-sm font-medium">
                                Batal
                            </button>
                            <button onclick="previewForm()"
                                class="flex-1 px-4 py-2.5 border border-simawa-500 text-simawa-600 rounded-lg hover:bg-simawa-50 transition-all text-sm font-medium">
                                <ion-icon name="eye-outline" class="mr-1"></ion-icon>
                                Preview
                            </button>
                            <button onclick="saveForm()"
                                class="flex-1 px-4 py-2.5 bg-gradient-to-r from-simawa-500 to-simawa-700 text-white rounded-lg hover:from-simawa-600 hover:to-simawa-800 transition-all text-sm font-medium">
                                Simpan Formulir
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Preview Modal -->
            <div id="previewModal" class="fixed inset-0 z-50 hidden overflow-y-auto">
                <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closePreviewModal()"></div>
                <div class="flex items-start justify-center min-h-screen p-4 pt-10">
                    <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-2xl transform transition-all">
                        <div class="p-6 border-b border-gray-100 flex items-center justify-between">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-800">Preview Formulir</h3>
                                <p id="previewFormTitle" class="text-sm text-gray-500 mt-1">-</p>
                            </div>
                            <button onclick="closePreviewModal()"
                                class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                <ion-icon name="close-outline" class="text-xl text-gray-500"></ion-icon>
                            </button>
                        </div>
                        <div id="previewContent" class="p-6 space-y-4 max-h-[60vh] overflow-y-auto">
                            <!-- Preview content will be rendered here -->
                        </div>
                        <div class="p-6 border-t border-gray-100">
                            <button onclick="closePreviewModal()"
                                class="w-full px-4 py-2.5 bg-gradient-to-r from-simawa-500 to-simawa-700 text-white rounded-lg hover:from-simawa-600 hover:to-simawa-800 transition-all text-sm font-medium">
                                Tutup Preview
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delete Form Modal -->
            <div id="deleteFormModal" class="fixed inset-0 z-50 hidden">
                <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeDeleteFormModal()"></div>
                <div class="flex items-center justify-center min-h-screen p-4">
                    <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-sm transform transition-all">
                        <div class="p-6 text-center">
                            <div
                                class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <ion-icon name="trash-outline" class="text-3xl text-red-500"></ion-icon>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-2">Hapus Formulir?</h3>
                            <p class="text-sm text-gray-500 mb-6">Data formulir yang dihapus tidak dapat dikembalikan.
                                Apakah Anda yakin?</p>
                            <div class="flex gap-3">
                                <button onclick="closeDeleteFormModal()"
                                    class="flex-1 px-4 py-2.5 border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-all text-sm font-medium">
                                    Batal
                                </button>
                                <button onclick="confirmDeleteForm()"
                                    class="flex-1 px-4 py-2.5 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all text-sm font-medium">
                                    Hapus
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Toast Notification -->
            <div id="toast"
                class="fixed bottom-6 right-6 z-50 transform translate-y-20 opacity-0 transition-all duration-300">
                <div class="flex items-center gap-3 px-4 py-3 bg-white rounded-lg shadow-lg border border-gray-100">
                    <ion-icon id="toastIcon" name="checkmark-circle" class="text-xl text-green-500"></ion-icon>
                    <span id="toastMessage" class="text-sm text-gray-700">Berhasil!</span>
                </div>
            </div>

            <script>
                // Sample Data
                let forms = [
                    {
                        id: 1,
                        title: 'Formulir Prestasi Mahasiswa',
                        categoryId: 1,
                        categoryName: 'Prestasi Mahasiswa',
                        questions: [
                            { id: 1, text: 'Nama Lengkap Mahasiswa', type: 'text', required: true },
                            { id: 2, text: 'NIM', type: 'text', required: true },
                            { id: 3, text: 'Program Studi', type: 'dropdown', required: true, options: ['Teknik Informatika', 'Sistem Informasi', 'Manajemen', 'Akuntansi'] },
                            { id: 4, text: 'Tingkat Prestasi', type: 'dropdown', required: true, options: ['Internasional', 'Nasional', 'Provinsi', 'Kabupaten/Kota'] },
                            { id: 5, text: 'Nama Kompetisi/Lomba', type: 'text', required: true },
                            { id: 6, text: 'Peringkat/Juara', type: 'dropdown', required: true, options: ['Juara 1', 'Juara 2', 'Juara 3', 'Harapan', 'Finalis', 'Peserta'] },
                            { id: 7, text: 'Upload Sertifikat', type: 'file', required: true },
                            { id: 8, text: 'Upload Dokumentasi', type: 'file', required: false }
                        ],
                        createdAt: '2026-01-20'
                    },
                    {
                        id: 2,
                        title: 'Formulir Penyelenggara Kegiatan',
                        categoryId: 2,
                        categoryName: 'Penyelenggara Kegiatan',
                        questions: [
                            { id: 1, text: 'Nama Kegiatan', type: 'text', required: true },
                            { id: 2, text: 'Deskripsi Kegiatan', type: 'text', required: true },
                            { id: 3, text: 'Tanggal Pelaksanaan', type: 'text', required: true },
                            { id: 4, text: 'Jumlah Peserta', type: 'dropdown', required: true, options: ['< 50', '50-100', '100-500', '> 500'] },
                            { id: 5, text: 'Upload SK Kegiatan', type: 'file', required: true }
                        ],
                        createdAt: '2026-01-18'
                    }
                ];

                let currentQuestions = [];
                let questionIdCounter = 0;
                let deleteFormId = null;

                const categoryNames = {
                    '1': 'Prestasi Mahasiswa',
                    '2': 'Penyelenggara Kegiatan',
                    '3': 'Rekognisi Non Lomba'
                };

                // Render Forms List
                function renderFormsList() {
                    const container = document.getElementById('formsList');
                    const emptyState = document.getElementById('emptyState');

                    if (forms.length === 0) {
                        container.innerHTML = '';
                        emptyState.classList.remove('hidden');
                        return;
                    }

                    emptyState.classList.add('hidden');
                    container.innerHTML = forms.map(form => `
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-5 hover:shadow-md transition-all">
                    <div class="flex items-start justify-between gap-4">
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-simawa-100 to-simawa-200 flex items-center justify-center">
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800">${form.title}</h4>
                                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-700">
                                        ${form.categoryName}
                                    </span>
                                </div>
                            </div>
                            <div class="flex items-center gap-4 text-sm text-gray-500 mt-3">
                                <span class="flex items-center gap-1">
                                    <ion-icon name="help-circle-outline"></ion-icon>
                                    ${form.questions.length} Pertanyaan
                                </span>
                                <span class="flex items-center gap-1">
                                    <ion-icon name="calendar-outline"></ion-icon>
                                    ${form.createdAt}
                                </span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                            <button onclick="viewFormPreview(${form.id})" 
                                class="p-2 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors" title="Preview">
                                <ion-icon name="eye-outline" class="text-lg"></ion-icon>
                            </button>
                            <button onclick="editForm(${form.id})" 
                                class="p-2 text-amber-500 hover:bg-amber-50 rounded-lg transition-colors" title="Edit">
                                <ion-icon name="create-outline" class="text-lg"></ion-icon>
                            </button>
                            <button onclick="deleteForm(${form.id})" 
                                class="p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors" title="Hapus">
                                <ion-icon name="trash-outline" class="text-lg"></ion-icon>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
                }

                // Open Form Modal
                function openFormModal() {
                    document.getElementById('formModal').classList.remove('hidden');
                    document.getElementById('formModalTitle').textContent = 'Buat Formulir Baru';
                    document.getElementById('formTitle').value = '';
                    document.getElementById('formCategory').value = '1';
                    document.getElementById('editFormId').value = '';
                    currentQuestions = [];
                    questionIdCounter = 0;
                    renderQuestions();
                }

                // Close Form Modal
                function closeFormModal() {
                    document.getElementById('formModal').classList.add('hidden');
                }

                // Add Question
                function addQuestion() {
                    questionIdCounter++;
                    currentQuestions.push({
                        id: questionIdCounter,
                        text: '',
                        type: 'text',
                        required: true,
                        options: []
                    });
                    renderQuestions();
                }

                // Remove Question
                function removeQuestion(id) {
                    currentQuestions = currentQuestions.filter(q => q.id !== id);
                    renderQuestions();
                }

                // Update Question
                function updateQuestion(id, field, value) {
                    const question = currentQuestions.find(q => q.id === id);
                    if (question) {
                        question[field] = value;
                        // Initialize options array for dropdown if not exists
                        if (field === 'type' && value === 'dropdown' && !question.options) {
                            question.options = [''];
                        }
                    }
                }

                // Add Option to Dropdown
                function addOption(questionId) {
                    const question = currentQuestions.find(q => q.id === questionId);
                    if (question) {
                        if (!question.options) question.options = [];
                        question.options.push('');
                        renderQuestions();
                    }
                }

                // Update Option
                function updateOption(questionId, optionIndex, value) {
                    const question = currentQuestions.find(q => q.id === questionId);
                    if (question && question.options) {
                        question.options[optionIndex] = value;
                    }
                }

                // Remove Option from Dropdown
                function removeOption(questionId, optionIndex) {
                    const question = currentQuestions.find(q => q.id === questionId);
                    if (question && question.options && question.options.length > 1) {
                        question.options.splice(optionIndex, 1);
                        renderQuestions();
                    } else if (question && question.options && question.options.length === 1) {
                        // Keep at least one empty option
                        question.options[0] = '';
                        renderQuestions();
                    }
                }

                // Render Questions
                function renderQuestions() {
                    const container = document.getElementById('questionsContainer');
                    const noQuestions = document.getElementById('noQuestions');

                    if (currentQuestions.length === 0) {
                        container.innerHTML = '';
                        noQuestions.classList.remove('hidden');
                        return;
                    }

                    noQuestions.classList.add('hidden');
                    container.innerHTML = currentQuestions.map((q, index) => `
                <div class="bg-gray-50 rounded-xl p-4 border border-gray-100">
                    <div class="flex items-start justify-between gap-3 mb-3">
                        <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-simawa-500 text-white text-xs font-medium">${index + 1}</span>
                        <button onclick="removeQuestion(${q.id})" class="p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors">
                            <ion-icon name="close-outline" class="text-lg"></ion-icon>
                        </button>
                    </div>
                    <div class="space-y-3">
                        <input type="text" value="${q.text}" onchange="updateQuestion(${q.id}, 'text', this.value)"
                            class="w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-simawa-500/20 focus:border-simawa-500 transition-all text-sm"
                            placeholder="Tulis pertanyaan...">
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-xs text-gray-500 mb-1">Tipe Jawaban</label>
                                <select onchange="updateQuestion(${q.id}, 'type', this.value); renderQuestions()"
                                    class="w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-simawa-500/20 focus:border-simawa-500 transition-all text-sm">
                                    <option value="text" ${q.type === 'text' ? 'selected' : ''}>Teks</option>
                                    <option value="dropdown" ${q.type === 'dropdown' ? 'selected' : ''}>Dropdown</option>
                                    <option value="file" ${q.type === 'file' ? 'selected' : ''}>File Upload</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-xs text-gray-500 mb-1">Wajib Diisi</label>
                                <select onchange="updateQuestion(${q.id}, 'required', this.value === 'true')"
                                    class="w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-simawa-500/20 focus:border-simawa-500 transition-all text-sm">
                                    <option value="true" ${q.required ? 'selected' : ''}>Ya, Wajib</option>
                                    <option value="false" ${!q.required ? 'selected' : ''}>Tidak</option>
                                </select>
                            </div>
                        </div>
                        ${q.type === 'dropdown' ? `
                            <div class="space-y-2">
                                <label class="block text-xs text-gray-500">Opsi Dropdown</label>
                                <div id="options-${q.id}" class="space-y-2">
                                    ${(q.options && q.options.length > 0) ? q.options.map((opt, optIndex) => `
                                        <div class="flex items-center gap-2">
                                            <div class="w-4 h-4 rounded-full border-2 border-gray-300 flex-shrink-0"></div>
                                            <input type="text" value="${opt}" 
                                                onchange="updateOption(${q.id}, ${optIndex}, this.value)"
                                                class="flex-1 px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-simawa-500/20 focus:border-simawa-500 transition-all text-sm"
                                                placeholder="Opsi ${optIndex + 1}">
                                            <button onclick="removeOption(${q.id}, ${optIndex})" 
                                                class="p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors"
                                                title="Hapus opsi">
                                                <ion-icon name="close-outline" class="text-lg"></ion-icon>
                                            </button>
                                        </div>
                                    `).join('') : `
                                        <div class="flex items-center gap-2">
                                            <div class="w-4 h-4 rounded-full border-2 border-gray-300 flex-shrink-0"></div>
                                            <input type="text" value="" 
                                                onchange="updateOption(${q.id}, 0, this.value)"
                                                class="flex-1 px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-simawa-500/20 focus:border-simawa-500 transition-all text-sm"
                                                placeholder="Opsi 1">
                                            <button onclick="removeOption(${q.id}, 0)" 
                                                class="p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors"
                                                title="Hapus opsi">
                                                <ion-icon name="close-outline" class="text-lg"></ion-icon>
                                            </button>
                                        </div>
                                    `}
                                </div>
                                <button onclick="addOption(${q.id})" 
                                    class="inline-flex items-center gap-1.5 text-sm text-simawa-500 hover:text-simawa-700 font-medium mt-1">
                                    <ion-icon name="add-circle-outline"></ion-icon>
                                    Tambah Opsi
                                </button>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');
                }

                // Edit Form
                function editForm(id) {
                    const form = forms.find(f => f.id === id);
                    if (form) {
                        document.getElementById('formModal').classList.remove('hidden');
                        document.getElementById('formModalTitle').textContent = 'Edit Formulir';
                        document.getElementById('formTitle').value = form.title;
                        document.getElementById('formCategory').value = form.categoryId;
                        document.getElementById('editFormId').value = form.id;
                        currentQuestions = JSON.parse(JSON.stringify(form.questions));
                        questionIdCounter = Math.max(...currentQuestions.map(q => q.id), 0);
                        renderQuestions();
                    }
                }

                // Save Form
                function saveForm() {
                    const title = document.getElementById('formTitle').value;
                    const categoryId = document.getElementById('formCategory').value;
                    const editFormId = document.getElementById('editFormId').value;

                    if (!title) {
                        showToast('Nama formulir harus diisi!', 'error');
                        return;
                    }

                    if (currentQuestions.length === 0) {
                        showToast('Tambahkan minimal 1 pertanyaan!', 'error');
                        return;
                    }

                    const hasEmptyQuestion = currentQuestions.some(q => !q.text);
                    if (hasEmptyQuestion) {
                        showToast('Semua pertanyaan harus diisi!', 'error');
                        return;
                    }

                    const formData = {
                        title,
                        categoryId: parseInt(categoryId),
                        categoryName: categoryNames[categoryId],
                        questions: currentQuestions,
                        createdAt: new Date().toISOString().split('T')[0]
                    };

                    if (editFormId) {
                        const index = forms.findIndex(f => f.id === parseInt(editFormId));
                        if (index !== -1) {
                            forms[index] = { ...forms[index], ...formData };
                            showToast('Formulir berhasil diperbarui!', 'success');
                        }
                    } else {
                        const newId = forms.length > 0 ? Math.max(...forms.map(f => f.id)) + 1 : 1;
                        forms.push({ id: newId, ...formData });
                        showToast('Formulir berhasil dibuat!', 'success');
                    }

                    closeFormModal();
                    renderFormsList();
                }

                // Preview Form
                function previewForm() {
                    const title = document.getElementById('formTitle').value || 'Formulir Tanpa Judul';
                    document.getElementById('previewFormTitle').textContent = title;
                    renderPreview(currentQuestions);
                    document.getElementById('previewModal').classList.remove('hidden');
                }

                // View Form Preview
                function viewFormPreview(id) {
                    const form = forms.find(f => f.id === id);
                    if (form) {
                        document.getElementById('previewFormTitle').textContent = form.title;
                        renderPreview(form.questions);
                        document.getElementById('previewModal').classList.remove('hidden');
                    }
                }

                // Render Preview
                function renderPreview(questions) {
                    const container = document.getElementById('previewContent');

                    if (questions.length === 0) {
                        container.innerHTML = '<p class="text-center text-gray-500 py-8">Tidak ada pertanyaan untuk ditampilkan</p>';
                        return;
                    }

                    container.innerHTML = questions.map((q, index) => `
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-gray-700">
                        ${index + 1}. ${q.text || 'Pertanyaan belum diisi'}
                        ${q.required ? '<span class="text-red-500">*</span>' : ''}
                    </label>
                    ${q.type === 'text' ? `
                        <input type="text" disabled
                            class="w-full px-4 py-2.5 border border-gray-200 rounded-lg bg-gray-50 text-sm"
                            placeholder="Jawaban teks...">
                    ` : ''}
                    ${q.type === 'dropdown' ? `
                        <select disabled class="w-full px-4 py-2.5 border border-gray-200 rounded-lg bg-gray-50 text-sm">
                            <option value="">Pilih salah satu...</option>
                            ${q.options ? q.options.map(opt => `<option>${opt}</option>`).join('') : ''}
                        </select>
                    ` : ''}
                    ${q.type === 'file' ? `
                        <div class="border-2 border-dashed border-gray-200 rounded-lg p-4 text-center bg-gray-50">
                            <ion-icon name="cloud-upload-outline" class="text-3xl text-gray-400 mb-2"></ion-icon>
                            <p class="text-sm text-gray-500">Klik atau drag file untuk upload</p>
                            <p class="text-xs text-gray-400 mt-1">PDF, JPG, PNG (Max. 5MB)</p>
                        </div>
                    ` : ''}
                </div>
            `).join('');
                }

                // Close Preview Modal
                function closePreviewModal() {
                    document.getElementById('previewModal').classList.add('hidden');
                }

                // Delete Form
                function deleteForm(id) {
                    deleteFormId = id;
                    document.getElementById('deleteFormModal').classList.remove('hidden');
                }

                // Close Delete Form Modal
                function closeDeleteFormModal() {
                    document.getElementById('deleteFormModal').classList.add('hidden');
                    deleteFormId = null;
                }

                // Confirm Delete Form
                function confirmDeleteForm() {
                    if (deleteFormId) {
                        forms = forms.filter(f => f.id !== deleteFormId);
                        showToast('Formulir berhasil dihapus!', 'success');
                        renderFormsList();
                    }
                    closeDeleteFormModal();
                }

                // Show Toast
                function showToast(message, type = 'success') {
                    const toast = document.getElementById('toast');
                    const toastIcon = document.getElementById('toastIcon');
                    const toastMessage = document.getElementById('toastMessage');

                    toastMessage.textContent = message;
                    toastIcon.setAttribute('name', type === 'success' ? 'checkmark-circle' : 'alert-circle');
                    toastIcon.className = `text-xl ${type === 'success' ? 'text-green-500' : 'text-red-500'}`;

                    toast.classList.remove('translate-y-20', 'opacity-0');

                    setTimeout(() => {
                        toast.classList.add('translate-y-20', 'opacity-0');
                    }, 3000);
                }

                // Initialize
                renderFormsList();
            </script>
        </main>
    </div>
</body>

</html>